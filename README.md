# wsi-checker

Utility for running WS-I.org Basic Profile 1.1 validation tool

The tool also include options to:

* Generate the configuration file that the WS-I.org Basic Profile 1.1 validation tool require as input
* Extract the files (schemas etc) that the WS-I.org Basic Profile 1.1 validation tool need access to during execution

## Build/test

To build stand alone jar: mvn package

To get help for the tools included in the standalone jar:

* WSDL analyzer: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -help -analyze
* Configuration file generator: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -help -generateConfig
* WS-I tool extractor: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -help -unpackTool

### Quick test run

Note: Requires that Python (2.x or 3.x) and the Google Chrome browser are installed.

```shell
cd scripts
./testrun.sh
```

These commands will
* build the stand alone jar
* extract the WS-I tool files
* generate a config file
* run the analyzer
* start a local web server
* and open a browser to display the generated report

Run the following command to get the process id of the web server: ps | grep python

### Tool to analyze wsdl

* Help: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -help -analyze
* Run: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -analyze -config file -root folder [-summary file]

Examples:

* java -jar target/wsi-checker-1.0-SNAPSHOT.jar -analyze -config target/config.xml -root target/wsi-root
* java -jar target/wsi-checker-1.0-SNAPSHOT.jar -analyze -config target/config.xml -root target/wsi-root
 -summary target/summary.json

### Tool to generate wsi configuration file

* Help: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -help -generateConfig
* Run: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -generateConfig -root folder -wsdl file -report file -output file

See help for additional options

Example: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -generateConfig -root target/wsi-root
 -wsdl src/test/resources/wsdl/wsdl_1.wsdl -report target/report.xml -output target/config.xml

### Tool to extract WS-I tool support files

* Help: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -help -unpackTool
* Run: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -unpackTool -root folder

Example: java -jar target/wsi-checker-1.0-SNAPSHOT.jar -unpackTool -root target/wsi-root

## Content

### src/main/java

* WsiBasicProfileChecker Generate config file, run validator, analyze result (see tests for example usage).
* ReportParser Simple DOM parser for extracting information from the report file generated by the validator tool.
* Util Utility functions to access bindings in wsdl, read template file, etc.
* check/. Classes used to collect error/warning information.
* wsi_binding_config_template.xml Template used to create a config file that the ws-i tool need as input.

### WS-I

The WS-I folder contains the ws-i.org basic profile libraries, profiles schemas etc. The java/lib folder has
been cleaned up to just contain the libraries (wsi-test-tools.jar, wsdl4j.jar, uddi4j.jar) and xerces has been
moved to the pom. These are the jar files that this project need for the WSDL validation being performed. Other
validations may need more of the libraries from the standard tool distribution.

The libraries have also been installed in the local maven repository (WS-I/repository) to enable building stand
alone (executable) jars.

#### Example: Running the analyzer from a Java program

``` java
    public runner() throws IOException {
        ProcessBuilder builder = new ProcessBuilder("java", "-jar", "target/wsi-checker-1.0-SNAPSHOT.jar",
            "-analyze", "-root", "target/wsi-root", "-config", "target/config.xml", "-summary", "target/summary.json");
        Process process = builder.start();
        InputStream fromProcess = process.getInputStream();
        BufferedReader reader = new BufferedReader(new InputStreamReader(fromProcess));
        String line;
        boolean success = false;
        while ((line = reader.readLine()) != null) {
            if (line.startsWith("WSDL analysis completed with status: SUCCESS")) {
                success = true;
            }
        }
        System.out.println(success ? "Success" : "failure");
    }
```
